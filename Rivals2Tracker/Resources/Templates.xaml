<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:data="clr-namespace:Slipstream.Models"
                    xmlns:converters="clr-namespace:Slipstream.Resources.Converters" xmlns:i="http://schemas.microsoft.com/xaml/behaviors">

    <converters:IconConverter x:Key="IconConverter" />
    <converters:PortraitConverter x:Key="PortraitConverter" />
    <converters:WinLoseColorConverter x:Key="WinLoseColorConverter" />
    <converters:WinRatioToBackgroundConverter x:Key="WinRatioToColor" />
    <converters:WidthToRangeConverter x:Key="WidthToRangeConverter" />
    <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />

    <DataTemplate x:Key="RecentMatches1080" DataType="{x:Type data:MatchResult}">
        <Grid Height="70" Width="620" Background="{StaticResource LGR_Blue}" Opacity="0.8">
            <Border BorderBrush="{StaticResource GR_DarkBlue}" BorderThickness="1">
                <StackPanel Orientation="Horizontal">
                    <Label Content="{Binding Result}" Width="75" Margin="16, 0, 0, 0" HorizontalAlignment="Left" HorizontalContentAlignment="Left" VerticalAlignment="Center" FontSize="24"
                               Foreground="{Binding Result, Converter={StaticResource WinLoseColorConverter}}" FontFamily="Franklin Gothic Demi Cond" />

                    <StackPanel Margin="0, 0, 0, 0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Grid Height="70" Margin="10, 0, 0, 0">
                            <Image Source="{Binding MyChar, Converter={StaticResource IconConverter}}" Height="36" Width="36" Margin="0" VerticalAlignment="Top"/>
                            <Label Content="{Binding MyElo}" FontFamily="{StaticResource AfterDisaster}" Width="50" FontSize="22" Margin="0, 0, 0, 0" Foreground="{StaticResource FG_WhiteLabel}"  
                                   VerticalAlignment="Bottom" HorizontalAlignment="Center" HorizontalContentAlignment="Center"/>
                        </Grid>

                        <Grid Height="70" Margin="12, 0, 0, 0">
                            <Image Source="{Binding OppChar1, Converter={StaticResource IconConverter}}" Height="36" Width="36" Margin="0" VerticalAlignment="Top"/>
                            <Label Content="{Binding OpponentElo}" FontFamily="{StaticResource AfterDisaster}" Width="50" Margin="0, 0, 0, 0" FontSize="22" Foreground="{StaticResource FG_WhiteLabel}"
                                   VerticalAlignment="Bottom" HorizontalAlignment="Center" HorizontalContentAlignment="Center"/>
                        </Grid>

                        <Grid>
                            <Image Source="{Binding OppChar2, Converter={StaticResource IconConverter}}" Height="32" Width="32" Margin="15, 0, 0, 0"/>
                        </Grid>

                        <Label Content="{Binding Opponent}" FontFamily="Franklin Gothic Demi Cond" Width="145" FontSize="21" Margin="15, 0, 0, 0" VerticalContentAlignment="Center" Foreground="{StaticResource FG_WhiteLabel}"/>
                    </StackPanel>

                    <StackPanel HorizontalAlignment="Right" Orientation="Horizontal" Width="155">
                        <Grid>
                            <Label Content="{Binding Date}" Foreground="{StaticResource FG_WhiteLabel}" Width="135" FontSize="18" VerticalAlignment="Top" Margin="5, 0, 0, 0"
                                   HorizontalAlignment="Right" HorizontalContentAlignment="Right" FontFamily="Franklin Gothic Demi Cond"/>
                            <Label Content="{Binding Patch}" Foreground="{StaticResource FG_GreyLabel}" Width="100" FontSize="17" HorizontalAlignment="Right" HorizontalContentAlignment="Right" Margin="0, 35, 0, 0" FontFamily="Franklin Gothic Demi Cond"/>
                        </Grid>
                    </StackPanel>

                    <Button Width="34" Height="34" Content="&#xE712;" FontSize="24" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Right" Margin="0, 0, 0, 0"
                        Foreground="{StaticResource FG_BlueLabel}" Background="{StaticResource BG_DarkBlue}" BorderBrush="{StaticResource LGR_Blue}"
                        Command="{Binding ShowMatchDetailsCommand}" BorderThickness="2" />
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="RecentMatches1440" DataType="{x:Type data:MatchResult}">
        <Grid Height="74" Width="810" Background="{StaticResource LGR_Blue}" Opacity="0.8">
            <Border BorderBrush="{StaticResource GR_DarkBlue}" BorderThickness="1" Width="840">
                <StackPanel Orientation="Horizontal" Width="840" >
                    <Label Content="{Binding Result}" Width="75" Margin="25, 0, 0, 0" HorizontalAlignment="Left" HorizontalContentAlignment="Left" VerticalAlignment="Center" FontSize="28"
                               Foreground="{Binding Result, Converter={StaticResource WinLoseColorConverter}}" FontFamily="Franklin Gothic Demi Cond" />

                    <StackPanel Margin="10, 0, 0, 0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Grid Height="74" Margin="10, 0, 0, 0">
                            <Image Source="{Binding MyChar, Converter={StaticResource IconConverter}}" Height="40" Width="40" Margin="0" VerticalAlignment="Top"/>
                            <Label Content="{Binding MyElo}" FontFamily="{StaticResource AfterDisaster}" Width="50" FontSize="24" Margin="0, 0, 0, 0" Foreground="{StaticResource FG_WhiteLabel}"  
                                   VerticalAlignment="Bottom" HorizontalAlignment="Center" HorizontalContentAlignment="Center"/>
                        </Grid>

                        <Grid Height="74" Margin="15, 0, 0, 0">
                            <Image Source="{Binding OppChar1, Converter={StaticResource IconConverter}}" Height="40" Width="40" Margin="0" VerticalAlignment="Top"/>
                            <Label Content="{Binding OpponentElo}" FontFamily="{StaticResource AfterDisaster}" Width="50" Margin="0, 0, 0, 0" FontSize="24" Foreground="{StaticResource FG_WhiteLabel}"
                                   VerticalAlignment="Bottom" HorizontalAlignment="Center" HorizontalContentAlignment="Center"/>
                        </Grid>

                        <Grid>
                            <Image Source="{Binding OppChar2, Converter={StaticResource IconConverter}}" Height="32" Width="32" Margin="15, 0, 0, 0"/>
                        </Grid>

                        <Label Content="{Binding Opponent}" FontFamily="Franklin Gothic Demi Cond" Width="180" FontSize="26" Margin="50, 0, 0, 0" VerticalContentAlignment="Center" Foreground="{StaticResource FG_WhiteLabel}"/>
                    </StackPanel>

                    <StackPanel HorizontalAlignment="Right" Orientation="Horizontal" Width="230">
                        <Grid>
                            <Label Content="{Binding Date}" Foreground="{StaticResource FG_WhiteLabel}" Width="190" FontSize="22" VerticalAlignment="Top" Margin="5, 0, 0, 0"
                                   HorizontalAlignment="Right" HorizontalContentAlignment="Right" FontFamily="Franklin Gothic Demi Cond"/>
                            <Label Content="{Binding Patch}" Foreground="{StaticResource FG_GreyLabel}" Width="100" FontSize="18" HorizontalAlignment="Right" HorizontalContentAlignment="Right" Margin="0, 35, 0, 0" FontFamily="Franklin Gothic Demi Cond"/>
                        </Grid>
                    </StackPanel>

                    <Button Width="38" Height="38" Content="&#xE712;" FontSize="24" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Right" Margin="0, 0, 0, 0"
                        Foreground="{StaticResource FG_BlueLabel}" Background="{StaticResource BG_DarkBlue}" BorderBrush="{StaticResource LGR_Blue}"
                        Command="{Binding ShowMatchDetailsCommand}" BorderThickness="2" />
                </StackPanel>
            </Border>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="MetaResults1440">
        <Grid Height="180" Width="200" Background="{StaticResource LGR_Blue_Opacity}" Opacity="0.83">
            <StackPanel Orientation="Vertical" Margin="0, 20, 0, 0">
                <Image Source="{Binding Character, Converter={StaticResource IconConverter}}" Height="56" Width="56" Margin="0, 0, 0, 0"/>
                <Label Content="{Binding RecordString}" Margin="0, 5, 0, 0"  HorizontalAlignment="Center" HorizontalContentAlignment="Center" FontSize="24" FontFamily="Franklin Gothic Demi Cond"/>

                <Grid Margin="0, 0, 0, 0">
                    <StackPanel Margin="10, 0, 0, 0" HorizontalAlignment="Left" Width="90" >
                        <Label Content="Win %" Foreground="{StaticResource FG_GreyLabel}" FontFamily="Franklin Gothic Demi Cond" FontSize="16" FontWeight="Light" HorizontalContentAlignment="Center"/>
                        <Label Content="{Binding WinRatioString}" Foreground="{Binding WinRatioString, Converter={StaticResource WinRatioToColor}}" Margin="0, 0, 0, 5"
                        VerticalAlignment="Center" FontSize="22" FontFamily="{StaticResource AfterDisaster}" HorizontalContentAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Margin="0, 0, 10, 0" HorizontalAlignment="Right" Width="90">
                        <Label Content="Weighed %" Foreground="{StaticResource FG_GreyLabel}" FontFamily="Franklin Gothic Demi Cond" FontSize="16" FontWeight="Light" HorizontalContentAlignment="Center"/>
                        <Label Content="{Binding WeightedData.AdjustedMatchupRating}" Foreground="{Binding WeightedData.AdjustedMatchupRating, Converter={StaticResource WinRatioToColor}}"
                        VerticalAlignment="Center" FontSize="22" FontFamily="{StaticResource AfterDisaster}" HorizontalContentAlignment="Center" Margin="0, 0, 0, 5"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="MetaResults1080">
        <Grid Height="135" Width="160" Background="{StaticResource LGR_Blue_Opacity}" Opacity="0.83">
            <StackPanel Orientation="Vertical" Margin="0, 10, 0, 0">
                <Image Source="{Binding Character, Converter={StaticResource IconConverter}}" Height="42" Width="42" Margin="0, 0, 0, 0"/>
                <Label Content="{Binding RecordString}" Margin="0, 0, 0, 0"  HorizontalAlignment="Center" HorizontalContentAlignment="Center" FontSize="18" FontFamily="Franklin Gothic Demi Cond"/>

                <Grid Margin="0, 0, 0, 0">
                    <StackPanel Margin="5, 0, 0, 0" HorizontalAlignment="Left" Width="80" >
                        <Label Content="Win %" Margin="0, -6, 0, 0" Foreground="{StaticResource FG_GreyLabel}" FontFamily="Franklin Gothic Demi Cond" FontSize="14" FontWeight="Light" HorizontalContentAlignment="Center"/>
                        <Label Content="{Binding WinRatioString}" Foreground="{Binding WinRatioString, Converter={StaticResource WinRatioToColor}}" Margin="0, -3, 0, 3"
                        VerticalAlignment="Center" FontSize="20" FontFamily="{StaticResource AfterDisaster}" HorizontalContentAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Margin="0, 0, 8, 0" HorizontalAlignment="Right" Width="80">
                        <Label Content="Weighed %" Margin="0, -6, 0, 0" Foreground="{StaticResource FG_GreyLabel}" FontFamily="Franklin Gothic Demi Cond" FontSize="14" FontWeight="Light" HorizontalContentAlignment="Center"/>
                        <Label Content="{Binding WeightedData.AdjustedMatchupRating}" Foreground="{Binding WeightedData.AdjustedMatchupRating, Converter={StaticResource WinRatioToColor}}"
                        VerticalAlignment="Center" FontSize="20" FontFamily="{StaticResource AfterDisaster}" HorizontalContentAlignment="Center" Margin="0, -3, 0, 3"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <!-- DataTemplate for New UI - My Character -->
    <DataTemplate x:Key="MyCharacterItemTemplateNew">
        <Button Style="{StaticResource ImageFlyoutButtonStyle}"
               Command="{Binding DataContext.SetMyCharacterCommand, RelativeSource={RelativeSource AncestorType=Grid}}"
               CommandParameter="{Binding}">
            <Image Source="{Binding Converter={StaticResource IconConverter}}" Stretch="UniformToFill"/>
        </Button>
    </DataTemplate>

    <!-- DataTemplate for New UI - Opp Character -->
    <DataTemplate x:Key="OppCharacterItemTemplateNew">
        <Button Style="{StaticResource ImageFlyoutButtonStyle}"
                   Command="{Binding DataContext.SetOppCharacterCommand, RelativeSource={RelativeSource AncestorType=Grid}}"
                   CommandParameter="{Binding}">
            <Image Source="{Binding Converter={StaticResource IconConverter}}" Stretch="UniformToFill"/>
        </Button>
    </DataTemplate>

    <DataTemplate x:Key="StageSelectorTemplate" DataType="{x:Type data:RivalsStage}">
        <Grid>
            <Image Width="100" Height="56" Source="{Binding StagePicture}" ToolTip="{Binding StageName}"/>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="TiltedStageList" DataType="{x:Type data:RivalsStage}">
        <Grid>
            <Grid.InputBindings>
                <!--<MouseBinding Gesture="RightClick" Command="{Binding ToggleBanStageCommand}" />
                <MouseBinding Gesture="LeftClick" Command="{Binding ToggleSelectStageCommand}" />-->
            </Grid.InputBindings>

            <!-- This is way faster than MouseBinding - Use this instead -->
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="MouseLeftButtonDown">
                    <i:InvokeCommandAction Command="{Binding ToggleSelectStageCommand}" />
                </i:EventTrigger>
                <i:EventTrigger EventName="MouseRightButtonDown">
                    <i:InvokeCommandAction Command="{Binding ToggleBanStageCommand}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
            
            <!-- Outer Border -->
            <Path Stroke="Black" StrokeThickness="1" Fill="Gray">
                <Path.Data>
                    <PathGeometry>
                        <PathFigure StartPoint="15,0" IsClosed="True">
                            <LineSegment Point="75,0" />
                            <LineSegment Point="60,85" />
                            <LineSegment Point="0,85" />
                        </PathFigure>
                    </PathGeometry>
                </Path.Data>
            </Path>

            <!-- Stage Image -->
            <Image Source="{Binding StagePicture}"
               ToolTip="{Binding StageName}"
               Width="75" Height="97"
               Stretch="UniformToFill"
               Cursor="Hand">
                <Image.Clip>
                    <PathGeometry>
                        <PathFigure StartPoint="15,0" IsClosed="True">
                            <LineSegment Point="75,0" />
                            <LineSegment Point="60,85" />
                            <LineSegment Point="0,85" />
                        </PathFigure>
                    </PathGeometry>
                </Image.Clip>
            </Image>

            <!-- "Banned" Image -->
            <Image Width="75" Height="97" Margin="0, -12, 0, 0" Source="/Resources/StageIcons/StageBannedOverlay.png" 
               Visibility="{Binding IsBanned, Converter={StaticResource BoolToVisibilityConverter}}"
               IsHitTestVisible="False">
                <Image.Clip>
                    <PathGeometry>
                        <PathFigure StartPoint="15,0" IsClosed="True">
                            <LineSegment Point="75,0" />
                            <LineSegment Point="60,85" />
                            <LineSegment Point="0,85" />
                        </PathFigure>
                    </PathGeometry>
                </Image.Clip>
            </Image>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="MatchGamesTemplate1440" DataType="{x:Type data:RivalsGame}">
        <Grid Height="190">
            <TextBlock Margin="36, 20, 0, 0" Text="{Binding GameNumber, StringFormat='Game {0}'}" FontFamily="Franklin Gothic Demi Cond"
                Foreground="White" FontSize="28" />
            <Grid>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0, 5, 0, 0">
                    <!-- Character Select Buttons -->
                    <Grid Margin="0, 0, 0, 0" VerticalAlignment="Top" HorizontalAlignment="Center"> 
                        <!-- My Button-->
                        <Button Name="MyCharacterRoot" Grid.Row="0" Width="60" Height="60" HorizontalAlignment="Left" Command="{Binding ShowMyFlyoutCommand}"
                                    BorderThickness="2" BorderBrush="Transparent" Style="{StaticResource MainImageButtonStyle}">
                            <Button.Background>
                                <ImageBrush ImageSource="{Binding MySelectedImagePath}" Stretch="UniformToFill"/>
                            </Button.Background>
                        </Button>

                        <!-- My Flyout -->

                        <Popup Name="ImageFlyoutMN" Grid.Row="0" PlacementTarget="{Binding ElementName=MyCharacterRoot}" Placement="Bottom" IsOpen="{Binding IsMyFlyoutOpen}" StaysOpen="False"
                                AllowsTransparency="True" PopupAnimation="Slide">
                            <Border Background="{StaticResource BG_DarkBlue}" BorderBrush="{StaticResource FG_BlueLabel}" BorderThickness="1" CornerRadius="0" Padding="0">
                                <Border.Effect>
                                    <DropShadowEffect Color="Black" Direction="315" ShadowDepth="5" Opacity="0.3"/>
                                </Border.Effect>

                                <StackPanel>
                                    <Label Content="My Character" FontSize="22" FontFamily="Franklin Gothic Demi Cond" HorizontalAlignment="Center" Foreground="{StaticResource FG_BlueLabel}"/>
                                    <Border BorderThickness="0, 0, 0, 1" Margin="20, 0, 20, 0" BorderBrush="White"/>
                                    <ItemsControl ItemsSource="{Binding AvailableCharacters}" ItemTemplate="{StaticResource MyCharacterItemTemplateNew}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel Width="280" Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                        </Popup>
                    </Grid>
                    <Label Content="VS" Margin="10, 0, 0, 0" FontSize="28" Foreground="White"/>
                    <Grid Margin="0, 0, 0, 0" VerticalAlignment="Top" HorizontalAlignment="Center">
                        <!-- Opp Button -->

                        <Button Name="MyOppRoot" Grid.Row="0" Width="60" Height="60" Margin="10, 0, 0, 0" HorizontalAlignment="Left" Command="{Binding ShowOppFlyoutCommand}"
                                    BorderThickness="2" BorderBrush="Transparent" Style="{StaticResource MainImageButtonStyle}">
                            <Button.Background>
                                <ImageBrush ImageSource="{Binding OppSelectedImagePath}" Stretch="UniformToFill"/>
                            </Button.Background>
                        </Button>

                        <!-- Opp Flyout -->

                        <Popup Name="ImageFlyoutON" Grid.Row="0" PlacementTarget="{Binding ElementName=MyOppRoot}" Placement="Bottom" IsOpen="{Binding IsOppFlyoutOpen}" StaysOpen="False"
                                AllowsTransparency="True" PopupAnimation="Slide">
                            <Border Background="{StaticResource BG_DarkBlue}" BorderBrush="{StaticResource FG_BlueLabel}" BorderThickness="1" CornerRadius="0" Padding="0">
                                <Border.Effect>
                                    <DropShadowEffect Color="Black" Direction="315" ShadowDepth="5" Opacity="0.3"/>
                                </Border.Effect>

                                <StackPanel>
                                    <Label Content="Opponent Character" FontSize="22" FontFamily="Franklin Gothic Demi Cond" HorizontalAlignment="Center" Foreground="{StaticResource FG_BlueLabel}"/>
                                    <Border BorderThickness="0, 0, 0, 1" Margin="20, 0, 20, 0" BorderBrush="White"/>
                                    <ItemsControl ItemsSource="{Binding AvailableCharacters}" ItemTemplate="{StaticResource OppCharacterItemTemplateNew}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel Width="280" Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                        </Popup>
                    </Grid>
                </StackPanel>

                <Grid>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0, 12, 10, 0">
                        <Button Content="Win" ToolTip="Set Game to 'Won'" Height="40" FontSize="24" Width="100" FontFamily="Franklin Gothic Demi" BorderThickness="2" Style="{StaticResource GameWinButtonStyle}" Command="{Binding SetGameWonCommand}"/>
                        <Button Content="Lose" ToolTip="Set Game to 'Lost'" Height="40" FontSize="24" Width="100" FontFamily="Franklin Gothic Demi" BorderThickness="2" Style="{StaticResource GameLoseButtonStyle}" Command="{Binding SetGameLostCommand}"/>
                    </StackPanel>
                </Grid>

                <ListView ItemsSource="{Binding AllStages}" ItemTemplate="{StaticResource TiltedStageList}" Width="820" Height="112"  BorderThickness="0" Background="Transparent"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Disabled" AlternationCount="100" VerticalAlignment="Top" Margin="0, 70, 0, 0">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem" BasedOn="{StaticResource EmptyListViewItem}">
                            <Setter Property="Padding" Value="0"/>
                            <Setter Property="Margin" Value="0"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Style.Triggers>
                                <!-- For the 6th item (index 5) -->
                                <Trigger Property="ItemsControl.AlternationIndex" Value="5">
                                    <Setter Property="Margin" Value="35, 0, 0, 0"/>
                                    <!-- add extra space on left -->
                                </Trigger>

                                <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                                    <Setter Property="Margin" Value="5, 0, 0, 0"/>
                                    <!-- add extra space on left -->
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ListView.ItemContainerStyle>
                    <ListView.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ListView.ItemsPanel>
                </ListView>
            </Grid>
        </Grid>
    </DataTemplate>

    <!-- DataTemplate for goofy flyout -->
    <DataTemplate x:Key="MyCharacterItemTemplate">
        <Button Style="{StaticResource ImageFlyoutButtonStyle}"
                   Command="{Binding DataContext.SelectMyCharacterCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                   CommandParameter="{Binding}">
            <Image Source="{Binding Converter={StaticResource PortraitConverter}}" Stretch="UniformToFill"/>
        </Button>
    </DataTemplate>

    <!-- DataTemplate for goofy flyout -->
    <DataTemplate x:Key="CharacterItemTemplate">
        <Button Style="{StaticResource ImageFlyoutButtonStyle}"
                   Command="{Binding DataContext.SelectCharacterCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                   CommandParameter="{Binding}">
            <Image Source="{Binding Converter={StaticResource IconConverter}}" Stretch="UniformToFill"/>
        </Button>
    </DataTemplate>

    <!-- DataTemplate for goofy flyout -->
    <DataTemplate x:Key="SecondaryCharacterItemTemplate">
        <Button Style="{StaticResource ImageFlyoutButtonStyle}"
                   Command="{Binding DataContext.SelectSecondaryCharacterCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                   CommandParameter="{Binding}">
            <Image Source="{Binding Converter={StaticResource IconConverter}}" Stretch="UniformToFill" />
        </Button>
    </DataTemplate>
</ResourceDictionary>